<!DOCTYPE html>
<html lang="zh-Hant">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>新聞事件動態視覺化</title>
    <style>
        html, body {
            margin: 0;
            padding: 0;
            overflow: hidden;
            touch-action: none;
        }
    </style>
</head>
<body>
    <script src="https://www.gstatic.com/firebasejs/8.10.1/firebase-app.js"></script>
    <script src="https://www.gstatic.com/firebasejs/8.10.1/firebase-database.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/p5@1.9.0/lib/p5.js"></script>

    <script>
        // 你的 Firebase 設定
        const firebaseConfig = {
            apiKey: "AIzaSyA-v1l71191TBGUz9e6VAzx0JLIMXriW7E",
            authDomain: "webtest-52f24.firebaseapp.com",
            databaseURL: "https://webtest-52f24-default-rtdb.firebaseio.com",
            projectId: "webtest-52f24",
            storageBucket: "webtest-52f24.firebasestorage.app",
            messagingSenderId: "162281112976",
            appId: "1:162281112976:web:e045be075e879d55629f15",
            measurementId: "G-J2EN7TBBHS"
        };
        firebase.initializeApp(firebaseConfig);
        
        const database = firebase.database();
        const pageRef = database.ref('currentPage');
        let currentSketch = null;

        // 這是你的第一個 CodePen 專案 (車禍事件)
        const sketch1 = function(p) {
            let words = "砂石車追撞、機車車頭嚴重變形、42 歲婦人、斷魂輪下、驚險一瞬間、當場沒了生命跡象、未婚、女強人、獨留年邁父親、白髮人送黑髮人";
            let wordList = [];
            
            p.setup = function() {
                p.createCanvas(p.windowWidth, p.windowHeight);
                p.textSize(30);
                p.textAlign(p.CENTER, p.CENTER);
                let tempWords = words.split('、');
                for (let i = 0; i < tempWords.length; i++) {
                    wordList.push({
                        text: tempWords[i],
                        x: p.width / 2,
                        y: p.height / 2,
                        vx: p.random(-3, 3),
                        vy: p.random(-3, 3)
                    });
                }
            };
            p.draw = function() {
                p.background(255);
                for (let i = 0; i < wordList.length; i++) {
                    let word = wordList[i];
                    word.x += word.vx;
                    word.y += word.vy;
                    if (word.x < 0 || word.x > p.width) { word.vx *= -1; }
                    if (word.y < 0 || word.y > p.height) { word.vy *= -1; }
                    p.fill(0);
                    p.text(word.text, word.x, word.y);
                }
            };
            p.mouseClicked = function() {
                for (let i = 0; i < wordList.length; i++) {
                    let word = wordList[i];
                    word.x = p.width / 2;
                    word.y = p.height / 2;
                    word.vx = p.random(-5, 5);
                    word.vy = p.random(-5, 5);
                }
            };
        };

        // 這是你的第二個 CodePen 專案 (遊覽車大火)
        const sketch2 = function(p) {
            let words = "喪生無情烈火、遊覽車大火吞噬幼稚園孩童、老師捨命犧牲、懷裡緊抱孩、火棺材、無一幸免、逃生門、司機過勞、萬念俱灰";
            let wordList = [];
            
            p.setup = function() {
                p.createCanvas(p.windowWidth, p.windowHeight);
                p.textSize(30);
                p.textAlign(p.CENTER, p.CENTER);
                let tempWords = words.split('、');
                for (let i = 0; i < tempWords.length; i++) {
                    wordList.push({
                        text: tempWords[i],
                        x: p.width / 2,
                        y: p.height / 2,
                        vx: p.random(-3, 3),
                        vy: p.random(-3, 3)
                    });
                }
            };
            p.draw = function() {
                p.background(0);
                for (let i = 0; i < wordList.length; i++) {
                    let word = wordList[i];
                    word.x += word.vx;
                    word.y += word.vy;
                    if (word.x < 0 || word.x > p.width) { word.vx *= -1; }
                    if (word.y < 0 || word.y > p.height) { word.vy *= -1; }
                    p.fill(255);
                    p.text(word.text, word.x, word.y);
                }
            };
            p.mouseClicked = function() {
                for (let i = 0; i < wordList.length; i++) {
                    let word = wordList[i];
                    word.x = p.width / 2;
                    word.y = p.height / 2;
                    word.vx = p.random(-5, 5);
                    word.vy = p.random(-5, 5);
                }
            };
        };

        // 這是我們控制頁面切換的程式碼
        pageRef.on('value', (snapshot) => {
            const pageId = snapshot.val();
            // 先移除舊的畫布，確保畫面乾淨
            if (currentSketch) {
                currentSketch.remove();
            }
            if (pageId === "page1") {
                currentSketch = new p5(sketch1);
            } else if (pageId === "page2") {
                currentSketch = new p5(sketch2);
            }
        });
    </script>
</body>
</html>